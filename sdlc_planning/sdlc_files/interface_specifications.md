# **Interface Specifications** #

|Function name|HTTP Method|Parameters|Return type|Exceptions|Description|
|-------------|-----------|----------|-----------|----------|-----------|
|call/start|POST|```{token, channel_id, is_cam_on, is_mic_on}```|```{call_id}```|**InputError** when any of: <br><ul><li> ```channel_id``` does not refer to a valid channel</ul> **AccessError** when any of: <br><ul><li> The authorised user is not joined the channel|Start a video call from authorised user in the channel specified by ```channel_id```. The authorised user becomes host of the call.|
|call/startdirect|POST|```{token, dm_id, is_cam_on, is_mic_on}```|```{call_id}```|**InputError** when any of: <br><ul><li> ```dm_id``` does not refer to a direct message chat</ul> **AccessError** when any of: <br><ul><li> The authorised user is not a participant in the direcgt message chat|Start a video call from authorised user in the direct message chat specified by ```dm_id```. There is no host in a direct message call.|
|call/end|DELETE|```{token, call_id}```|```{}```|**InputError** when any of: <br><ul><li> ```call_id``` refers to a call that doesn't exist</ul> **AccessError** when NONE of the following is true: <br><ul><li>  The user is the host of the video call <li> The call is in a direct message chat <li> The authorised user is a Flockr or channel owner|Given an existing video call by ```call_id```, end the call.|
|call/join|PUT|```{token, call_id, is_cam_on, is_mic_on}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist</ul> **AccessError**  when any of: <br><ul><li> The authorised user is not part of the channel or direct message chat where the call is being held|Given an existing video call by ```call_id```, add the authorised user as a participant to the call.|
|call/leave|PUT|```{token, call_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist</ul> **AccessError** when any of: <br><ul><li> The authorised user is not a participant in the call|Given an existing video call by ```call_id``` and an authorised user currently in the call, remove the user from call.|
|call/mic|PUT|```{token, call_id, is_mic_on}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist</ul> **AccessError** when any of: <br><ul><li> The authorised user is not a participant in the call|Given an existing video call by ```call_id``` and an authorised user currently in the call, change the user's microphone settings as per ```is_mic_on```.|
|call/camera|PUT|```{token, call_id, is_cam_on}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist</ul> **AccessError** when any of: <br><ul><li> The authorised user is not a participant in the call|Given an existing video call by ```call_id``` and an authorised user currently in the call, change the user's camera settings as per ```is_cam_on```.|
|call/startshare|POST|```{token, call_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> A screenshare is already in progress in the call</ul> **AccessError** when any of: <br><ul><li> The authorised user is not a participant in the call|Given an existing video call by ```call_id``` and an authorised user currently in the call, start sharing the user's screen.|
|call/endshare|DELETE|```{token, call_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> A screenshare is not in progress in the call</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the user who is screensharing|Given an existing video call by ```call_id``` and an authorised user currently sharing their screen, stop sharing the user's screen.|
|call/startrecord|PUT|```{token, call_id, is_video}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> The ```call_id``` refers to a direct message call <li> A recording has already started</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the host of the video call.|Given an existing video call by ```call_id``` and an authorised user that is the host of the call, start recording the video call in the background, recording audio-only if ```is_video``` is ```False```.|
|call/endrecord|PUT|```{token, call_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> A recording is not currently in progress</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the host of the video call.|Given an existing video call with a recording session active by ```call_id``` and an authorised user that is the host of the call, end the recording and save it as an audio or video file (depending on recording settings) on the user's local machine.|
|call/active|GET|```{token, channel_id}```|```{is_active}```|**InputError** when any of: <br><ul><li> ```channel_id``` does not refer to an existing channel|For a given channel, return whether a video call is active in it.|
|call/activedirect|GET|```{token, dm_id}```|```{is_active}```|**InputError** when any of: <br><ul><li> ```dm_id``` does not refer to an existing direct messsage chat|For a given direct message chat, return whether a video call is active in it.|
|call/adminmute|PUT|```{token, call_id, u_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> ```u_id``` does not refer to a participant in the call</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the host of the video call|Given an existing video call by ```call_id``` and an authorised user who is the host of the call, mute the microphone stream of the participant given by ```u_id```. Note that this overrides the user's own mic settings.|
|call/adminunmute|PUT|```{token, call_id, u_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> ```u_id``` does not refer to a participant in the call</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the host of the video call|Given an existing video call by ```call_id``` and an authorised user who is the host of the call, remove any admin mute placed on the microphone stream of the participant given by ```u_id```.|
|call/adminkick|PUT|```{token, call_id, u_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> ```u_id``` does not refer to a participant in the call</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the host of the video call|Given an existing video call by ```call_id``` and an authorised user who is the host of the call, remove the participant given by ```u_id``` from the call and prevent rejoining attempts for 30 minutes.|
|call/admintransfer|PUT|```{token, call_id, u_id}```|```{}```|**InputError** when any of: <br><ul><li>```call_id``` refers to a call that does not exist <li> ```u_id``` does not refer to a participant in the call</ul> **AccessError** when any of: <br><ul><li> The authorised user is not the host of the video call|Given an existing video call by ```call_id``` and an authorised user who is the host of the call, transfer host privileges to the participant marked by ```u_id```. Make sure host privileges are removed from user who successfully made the request.|
|channels/ groupcreate|POST|```{token, name}```|```{group_id}```|**InputError** when any of: </br> <ul><li> Name is more than 20 characters long|Creates a new channel group with that name.|
|channel/ groupaddchannel|PUT|```{token, group_id, channel_id}```|```{}```|**InputError** when any of: </br> <ul><li> Group does not exist</li><li> Channel with channel_id does not exist</ul> **AccessError** when any of: </br> <ul><li> User is not the creator of the group|Given a channel by its ```channel_id```, adds it to the channel group with ```group_id```.|
|direct/create|POST|```{token, u_id}```|```{dm_id}```|**InputError** when any of: </br> <ul><li> ```u_id``` does not refer to a valid user</li><li>```u_id``` refers to self (```token```)</li><li> A direct message chat already exists with that user|Given a user specified by ```u_id```, creates a direct message chat with the user.|
|direct/send|POST|```{token, dm_id, message}```|```{message_id}```|**InputError** when any of: </br><ul><li> Message is more than 1000 characters </li><li>```dm_id``` does not refer to a valid direct message chat</ul> **AccessError** when any of: <ul><li> The authorised user is not part of the direct message chat|Send a message from authorised to the direct message chat specified by ```dm_id```|
|direct/sendlater|POST|```{token, dm_id, message, time_sent}```|```{message_id}```|**InputError** when any of: <br><ul><li> Message is more than 1000 characters<li>```dm_id``` does not refer to a valid direct message chat<li>```time_sent``` is a time in the past</ul>**AccessError** when any of: <ul><li> The authorised user is not part of the direct message chat|Send a message from authorised user to the direct message chat specified by ```dm_id``` automatically at a time specified by ```time_sent```|
|file/send|POST|```{token, channel_id, path}```|```{file_id}```|**InputError** when any of:<br><ul><li> ```channel_id``` does not refer to a valid channel <li> ```path``` does not refer to a valid file <li> File is larger than 100 MB</ul> **AccessError** when any of: <br><ul><li> The authorised user has not joined the channel they are trying to send the file to|Send a file with file path given by ```path``` from authorised user to the channel specified by channel_id|
|file/senddirect|POST|```{token, dm_id, path}```|```{file_id}```|**InputError** when any of:<br><ul><li> ```dm_id``` does not refer to a valid direct message chat <li> ```path``` does not refer to a valid file <li> File is larger than 100 MB</ul>**AccessError** when any of: <ul><li> The authorised user is not part of the direct message chat|Send a file with file path given by ```path``` from authorised user to the direct message chat specified by dm_id|
|file/remove|DELETE|```{token, file_id}```|```{}```|**InputError** when any of: <br><ul><li> File given by ```file_id``` does not exist</ul> **AccessError** when NONE of the following is true: <br><ul><li> File was sent by the authorised user making this request <li> The authorised user is a Flockr or channel owner| Given a file by ```file_id```, the file is removed from the channel or direct message chat|
|file/expire|DELETE|```{token, file_id, expiry_time}```|```{}```|**InputError** when any of: <br><ul><li> File given by ```file_id``` does not exist <li>```expiry_time``` is a time in the past</ul> **AccessError** when NONE of the following is true: <br><ul><li> File was sent by the authorised user making this request <li> The authorised user is a Flockr or channel owner|Given a file by ```file_id```, the file is removed from the channel or direct message chat automatically at a time specified by ```expiry_time```|